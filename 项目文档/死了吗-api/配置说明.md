# 好着没 - 配置说明

后端需配置以下内容，填入 `.env` 文件。

---

## 1. 服务器配置

| 配置项 | 说明 | 示例 |
|--------|------|------|
| NODE_ENV | 运行环境 | development / production |
| HOST | 监听地址 | `0.0.0.0` 允许外网访问（部署 Sealos 必填）<br>`127.0.0.1` 仅本机 |
| PORT | 监听端口 | 本地 3000，Sealos 部署 8080 |

---

## 2. 微信小程序 AppID 和 Secret

**用途**：签到接口用 `code` 换取用户 `openid`，必须配置。

**获取步骤**：
1. 登录 [微信公众平台](https://mp.weixin.qq.com/)
2. 进入 **开发** → **开发管理** → **开发设置**
3. 复制 **AppID** 和 **AppSecret**（需管理员扫码确认）

**填入 .env**：
```
WECHAT_APPID=wx1234567890abcdef
WECHAT_SECRET=32位密文字符串
```

---

## 3. 邮件服务（SMTP）

**用途**：向「连续2天未签到」的用户发送提醒邮件。

### 3.1 QQ 邮箱

1. 登录 QQ 邮箱 → **设置** → **账户**
2. 找到 **POP3/IMAP/SMTP/Exchange/CardDAV/CalDAV服务**
3. 开启 **IMAP/SMTP服务** 或 **POP3/SMTP服务**
4. 按提示发送短信，获取 **授权码**（不是 QQ 登录密码）

**填入 .env**：
```
SMTP_HOST=smtp.qq.com
SMTP_PORT=465
SMTP_SECURE=true
SMTP_USER=你的QQ邮箱@qq.com
SMTP_PASS=授权码（16位）
SMTP_FROM=好着没提醒<你的QQ邮箱@qq.com>
```

### 3.2 163 邮箱

1. 登录 163 邮箱 → **设置** → **POP3/SMTP/IMAP**
2. 开启 **SMTP服务**
3. 设置授权码（首次需短信验证）

**填入 .env**：
```
SMTP_HOST=smtp.163.com
SMTP_PORT=465
SMTP_SECURE=true
SMTP_USER=你的163邮箱@163.com
SMTP_PASS=授权码
SMTP_FROM=好着没提醒<你的163邮箱@163.com>
```

### 3.3 自定义提醒内容

```
EMAIL_REMINDER_CONTENT=我连续2天都不好，快给我打个电话吧！
```

---

## 4. 数据库

已按你提供的地址写入 `.env`。本地开发时改为公网地址：

```
DB_HOST=dbconn.usw-1.sealos.app
DB_PORT=34575
```

DevBox 内使用内网：

```
DB_HOST=areyoudead-mysql.ns-bbah8da5.svc
DB_PORT=3306
```

---

## 5. 配置完成后

```bash
npm install
npm start
```
